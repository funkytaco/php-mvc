<div class="card" style="background: #e8f0ff; border: 2px solid #1976d2;">
    <h2>üîê Keycloak SSO Integration</h2>
    
    {{^user}}
    <div style="background: #fff3cd; padding: 1rem; border-radius: 4px; margin: 1rem 0;">
        <strong>‚ö†Ô∏è Not Authenticated</strong>
        <p>Click the "Login with Keycloak" button above to authenticate.</p>
    </div>
    
    <div style="margin-top: 1rem;">
        <h3>Configuration Status</h3>
        <p>Keycloak is enabled but may need configuration. If you haven't configured Keycloak yet:</p>
        <a href="/auth/configure" class="btn btn-success">Configure Keycloak</a>
    </div>
    {{/user}}
    
    {{#user}}
    <div style="background: #d4edda; padding: 1rem; border-radius: 4px; margin: 1rem 0;">
        <strong>‚úÖ Authenticated</strong>
        <p>You are currently logged in as:</p>
        <ul>
            <li><strong>Name:</strong> {{user.name}}</li>
            <li><strong>Email:</strong> {{user.email}}</li>
            <li><strong>Username:</strong> {{user.username}}</li>
        </ul>
    </div>
    {{/user}}
    
    <div style="margin-top: 1.5rem;">
        <h3>Protected Resources</h3>
        <p>When Keycloak is enabled, you can protect routes and resources based on authentication status.</p>
        
        <h4>Example Protected Routes:</h4>
        <ul>
            <li><code>/admin/*</code> - Admin panel (requires authentication)</li>
            <li><code>/api/secure/*</code> - Secured API endpoints</li>
            <li><code>/profile</code> - User profile page</li>
        </ul>
        
        <h4>Integration Features:</h4>
        <ul>
            <li>Single Sign-On (SSO) across applications</li>
            <li>Role-based access control (RBAC)</li>
            <li>OAuth 2.0 / OpenID Connect compliance</li>
            <li>User federation and identity brokering</li>
        </ul>
    </div>
    
    <div style="background: #f8f9fa; padding: 1rem; border-radius: 4px; margin-top: 1rem;">
        <h4>üîê Keycloak Admin Console Access</h4>
        <p><strong>URL:</strong> <a href="http://localhost:{{APP_PORT_KEYCLOAK}}" target="_blank">http://localhost:{{APP_PORT_KEYCLOAK}}</a></p>
        <p><strong>Admin Username:</strong> admin</p>
        {{#KEYCLOAK_ADMIN_PASSWORD}}
        <p><strong>Admin Password:</strong> {{KEYCLOAK_ADMIN_PASSWORD}}</p>
        {{/KEYCLOAK_ADMIN_PASSWORD}}
        {{^KEYCLOAK_ADMIN_PASSWORD}}
        <p><strong>Admin Password:</strong> (use vault command below to retrieve)</p>
        {{/KEYCLOAK_ADMIN_PASSWORD}}
        <p><strong>Custom Realm:</strong> {{KEYCLOAK_REALM}}</p>
        
        <div style="margin-top: 1rem; padding: 0.75rem; background: #d1ecf1; border-radius: 4px; border-left: 4px solid #17a2b8;">
            <h5>üë§ Test User Account</h5>
            <p><strong>Username:</strong> testuser</p>
            <p><strong>Password:</strong> testpass9898</p>
            <p><strong>Email:</strong> testuser@{{app_name}}.local</p>
            <p><em>This user is automatically created in the custom realm for testing.</em></p>
        </div>
        
        <div style="margin-top: 1rem; font-size: 0.9em; background: #e9ecef; padding: 0.5rem; border-radius: 4px;">
            <p><strong>üí° To retrieve admin password via vault:</strong></p>
            <code>composer nimbus:vault-view {{app_name}}</code>
            <p><strong>Or via container inspection:</strong></p>
            <code>podman inspect {{app_name}}-keycloak --format '{{range .Config.Env}}{{println .}}{{end}}' | grep KEYCLOAK_ADMIN_PASSWORD | cut -d'=' -f2</code>
        </div>
    </div>
</div>
