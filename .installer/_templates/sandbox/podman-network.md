# {{APP_NAME}} - Podman Network Hostnames

This document lists all available hostnames and endpoints for the **{{APP_NAME}}** application running in Podman containers.

## Container Network: `{{APP_NAME}}-net`

All containers run in an isolated Podman network named `{{APP_NAME}}-net`. Within this network, containers can communicate using their service names.

## Available Hostnames

### Application Services

#### Main Application
- **Container**: `{{APP_NAME}}-app`
- **Internal Hostname**: `{{APP_NAME}}-app:8080`
- **External Access**: `http://localhost:{{APP_PORT}}`
- **Description**: Main PHP/Apache application server

#### Primary Database
- **Container**: `{{APP_NAME}}-postgres`
- **Internal Hostname**: `{{APP_NAME}}-db:5432`
- **External Access**: Not exposed (internal only)
- **Description**: PostgreSQL database for application data
- **Database**: `{{APP_NAME}}_db`
- **User**: `{{APP_NAME}}_user`

### Keycloak Authentication (if enabled)

#### Keycloak Server
- **Container**: `{{APP_NAME}}-keycloak`
- **Internal Hostname**: `{{APP_NAME}}-keycloak:8080`
- **External Access**: `http://localhost:8080`
- **Description**: Keycloak authentication server
- **Admin Console**: `http://localhost:8080/admin`
- **Realm**: `{{APP_NAME}}-realm`

#### Keycloak Database
- **Container**: `{{APP_NAME}}-keycloak-db`
- **Internal Hostname**: `{{APP_NAME}}-keycloak-db:5432`
- **External Access**: Not exposed (internal only)
- **Description**: PostgreSQL database for Keycloak data
- **Database**: `keycloak_db`
- **User**: `keycloak`

#### Keycloak Setup (temporary)
- **Container**: `{{APP_NAME}}-keycloak-setup`
- **Description**: One-time setup container (runs and exits)
- **Purpose**: Automatically configures realm and client

### Event-Driven Ansible (if enabled)

#### EDA Rulebook Processor
- **Container**: `{{APP_NAME}}-eda`
- **Internal Hostname**: `{{APP_NAME}}-eda:5000`
- **External Access**: `http://localhost:{{EDA_PORT}}`
- **Description**: Ansible Event-Driven Automation rulebook processor
- **Webhook Endpoint**: `http://localhost:{{EDA_PORT}}/webhook`

## Service Discovery

### Internal Container Communication
Containers within the `{{APP_NAME}}-net` network can communicate using:
- Service names: `{{APP_NAME}}-app`, `{{APP_NAME}}-keycloak`, etc.
- Fully qualified names: `{{APP_NAME}}-app.{{APP_NAME}}-net`

### Example Internal URLs
```bash
# From any container in the network:
curl http://{{APP_NAME}}-app:8080/
curl http://{{APP_NAME}}-keycloak:8080/admin
curl http://{{APP_NAME}}-eda:5000/webhook
```

## External Access (from host)

### Web Interfaces
- **Application**: `http://localhost:{{APP_PORT}}`
- **Keycloak Admin**: `http://localhost:8080` (if Keycloak enabled)
- **EDA Webhooks**: `http://localhost:{{EDA_PORT}}` (if EDA enabled)

### Database Connections
```bash
# Application Database (via port forwarding)
podman port {{APP_NAME}}-postgres

# Keycloak Database (via port forwarding) 
podman port {{APP_NAME}}-keycloak-db
```

## macOS hostname Resolution (Optional)

To enable `.test` hostname resolution on macOS, add these entries to `/etc/hosts`:

```bash
# {{APP_NAME}} Nimbus app containers
127.0.0.1    {{APP_NAME}}-app.test
127.0.0.1    {{APP_NAME}}-keycloak.test
127.0.0.1    {{APP_NAME}}-db.test
127.0.0.1    {{APP_NAME}}-eda.test
# End {{APP_NAME}}
```

After adding these entries, you can access services using:
- `http://{{APP_NAME}}-app.test:{{APP_PORT}}`
- `http://{{APP_NAME}}-keycloak.test:8080`

## Container Status Commands

### Check All Containers
```bash
podman ps --filter "label=com.docker.compose.project={{APP_NAME}}"
```

### View Container Logs
```bash
podman logs {{APP_NAME}}-app
podman logs {{APP_NAME}}-keycloak
podman logs {{APP_NAME}}-eda
```

### Execute Commands in Containers
```bash
# Application container
podman exec -it {{APP_NAME}}-app bash

# Database container
podman exec -it {{APP_NAME}}-postgres psql -U {{APP_NAME}}_user -d {{APP_NAME}}_db

# Keycloak container
podman exec -it {{APP_NAME}}-keycloak bash
```

## Network Inspection

### View Network Details
```bash
podman network inspect {{APP_NAME}}_{{APP_NAME}}-net
```

### List All Containers in Network
```bash
podman network inspect {{APP_NAME}}_{{APP_NAME}}-net --format '{{range .Containers}}{{.Name}} - {{.IPv4Address}}{{"\n"}}{{end}}'
```

## Troubleshooting Network Issues

### Test Container Connectivity
```bash
# From host to container
curl -v http://localhost:{{APP_PORT}}/health

# Test internal network connectivity
podman exec {{APP_NAME}}-app curl -v http://{{APP_NAME}}-keycloak:8080/health
```

### View Container Network Configuration
```bash
podman inspect {{APP_NAME}}-app --format '{{range .NetworkSettings.Networks}}{{.NetworkID}} - {{.IPAddress}}{{end}}'
```

---

*This network configuration is automatically generated by the Nimbus framework based on your app's feature configuration.*